ensemble:~/p/ruby/vpim/trunk % time /opt/local/bin/ruby -I lib -rprofile ./profile.rb                
  %   cumulative   self              self     total
 time   seconds   seconds    calls  ms/call  ms/call  name
 20.53    73.27     73.27    80616     0.91     1.25  Vpim::Methods.casecmp?
 17.16   134.53     61.26    16916     3.62    47.95  Array#each
  7.87   162.61     28.08    66300     0.42     2.09  Proc#call
  7.63   189.85     27.24    79313     0.34     1.59  Vpim::DirectoryInfo::Field#name?
  4.71   206.67     16.82     6506     2.59     3.89  Vpim::DirectoryInfo::Field#decode0
  2.76   216.51      9.84    84516     0.12     0.12  String#==
  2.64   225.92      9.41    14300     0.66     1.68  Vpim::DirectoryInfo#enum_by_name
  2.53   234.94      9.02    80616     0.11     0.11  String#casecmp
  2.40   243.51      8.57    80691     0.11     0.11  Fixnum#==
  2.33   251.82      8.31    66300     0.13     0.13  Proc#==
  2.09   259.29      7.47    14300     0.52    14.92  Vpim::DirectoryInfo#each
  2.00   266.43      7.14    14300     0.50    15.42  Vpim::Enumerator#each
  1.80   272.85      6.42     6506     0.99     5.17  Vpim::DirectoryInfo::Field#initialize
  1.69   278.89      6.04    23413     0.26    26.02  Class#new
  1.66   284.80      5.91     1300     4.55   212.08  Vpim::Icalendar::Vevent#initialize
  1.48   290.08      5.28     7800     0.68    19.36  Vpim::DirectoryInfo#text
  1.46   295.30      5.22    14300     0.37     0.54  Proc#new
  1.07   299.11      3.81     6502     0.59     1.03  Vpim::DirectoryInfo::Field#param
  1.06   302.89      3.78        1  3780.00  4800.00  IO#each
  1.01   306.49      3.60     6502     0.55     1.58  Vpim::DirectoryInfo::Field#encoding
  0.99   310.02      3.53     6502     0.54     2.29  Vpim::DirectoryInfo::Field#value
  0.97   313.49      3.47     5200     0.67    15.40  Vpim::DirectoryInfo#field
  0.96   316.93      3.44    14300     0.24     0.24  Vpim::Enumerator#initialize
  0.87   320.03      3.10     7800     0.40    17.11  Enumerable.map
  0.82   322.97      2.94     6506     0.45     5.97  Vpim::DirectoryInfo::Field#decode
  0.72   325.54      2.57    22114     0.12     0.12  String#upcase
  0.69   328.01      2.47    14300     0.17     0.17  Object#initialize
  0.65   330.34      2.33     2600     0.90     1.71  String#scan
  0.49   332.09      1.75    16913     0.10     0.10  Array#<<
  0.48   333.81      1.72     7802     0.22     0.30  Hash#[]
  0.45   335.41      1.60    10405     0.15     0.15  Array#first
  0.42   336.91      1.50     7802     0.19     0.20  Kernel.===
  0.41   338.37      1.46     1301     1.12     3.43  Vpim::DirectoryInfo#initialize
  0.37   339.70      1.33     1300     1.02     4.68  Vpim::DirectoryInfo::Field#to_text
  0.36   340.97      1.27        1  1270.00 40120.00  Array#collect
  0.35   342.23      1.26    13024     0.10     0.10  Fixnum#>
  0.33   343.41      1.18     7808     0.15     0.15  Module#===
  0.29   344.46      1.05     6506     0.16     0.19  Hash#each
  0.29   345.48      1.02     1300     0.78    20.22  Vpim::DirectoryInfo#[]
  0.23   346.29      0.81     6506     0.12     0.12  String#length
  0.23   347.10      0.81     7806     0.10     0.10  Kernel.freeze
  0.22   347.90      0.80     7807     0.10     0.10  Array#push
  0.22   348.67      0.77     6506     0.12     0.12  MatchData#[]
  0.20   349.37      0.70     7809     0.09     0.09  String#to_str
  0.19   350.04      0.67     1301     0.51     5.18  Vpim.outer_inner
  0.18   350.67      0.63     3900     0.16     0.16  String#gsub
  0.17   351.29      0.62     6502     0.10     0.10  Hash#default
  0.17   351.88      0.59     6506     0.09     0.09  String#strip!
  0.16   352.46      0.58     1301     0.45     4.16  Vpim::DirectoryInfo#create
  0.16   353.04      0.58     6506     0.09     0.09  String#chomp!
  0.16   353.61      0.57     6506     0.09     0.09  String#size
  0.15   354.16      0.55     1303     0.42     1.44  Vpim::DirectoryInfo::Field#value?
  0.15   354.71      0.55    10411     0.05     0.05  Array#last
  0.15   355.25      0.54     1302     0.41     2.30  Enumerable.detect
  0.15   355.77      0.52     1300     0.40     0.88  Vpim.decode_text
  0.13   356.24      0.47     6526     0.07     0.07  Kernel.kind_of?
  0.04   356.40      0.16     1300     0.12     0.12  Hash#key?
  0.04   356.55      0.15       27     5.56    41.11  Kernel.require
  0.03   356.65      0.10     1301     0.08     0.08  Array#pop
  0.03   356.74      0.09     1300     0.07     0.07  Hash#[]=
  0.01   356.78      0.04      259     0.15     0.15  Module#method_added
  0.01   356.80      0.02        3     6.67    10.00  Integer#gcd
  0.01   356.82      0.02        3     6.67    20.00  Rational#reduce
  0.00   356.83      0.01        1    10.00    10.00  Date#civil_to_jd
  0.00   356.84      0.01        5     2.00     2.00  Rational#initialize
  0.00   356.85      0.01        1    10.00    20.00  Date#valid_civil?
  0.00   356.86      0.01       91     0.11     0.11  Symbol#to_i
  0.00   356.87      0.01        2     5.00    30.00  Rational#/
  0.00   356.88      0.01       82     0.12     0.12  Fixnum#*
  0.00   356.89      0.01       91     0.11     0.11  Fixnum#to_s
  0.00   356.89      0.00      107     0.00     0.00  Kernel.singleton_method_added
  0.00   356.89      0.00        5     0.00     0.00  Module#included
  0.00   356.89      0.00        2     0.00     0.00  Array#join
  0.00   356.89      0.00       28     0.00     0.00  Module#module_eval
  0.00   356.89      0.00        1     0.00     0.00  Class#new0
  0.00   356.89      0.00        2     0.00     0.00  Date#os?
  0.00   356.89      0.00        4     0.00     0.00  Float#*
  0.00   356.89      0.00        2     0.00     0.00  Fixnum#<=
  0.00   356.89      0.00        1     0.00     0.00  Module#module_function
  0.00   356.89      0.00        1     0.00 25780.00  Vpim.expand
  0.00   356.89      0.00        1     0.00     0.00  Kernel.singleton_method_undefined
  0.00   356.89      0.00        1     0.00    40.00  Rational#-
  0.00   356.89      0.00       24     0.00     0.00  Fixnum#>>
  0.00   356.89      0.00       10     0.00     0.00  Float#floor
  0.00   356.89      0.00        8     0.00     0.00  Module#private_class_method
  0.00   356.89      0.00       11     0.00     0.00  Fixnum#+
  0.00   356.89      0.00        4     0.00     0.00  Module#attr_reader
  0.00   356.89      0.00        3     0.00     0.00  Fixnum#<<
  0.00   356.89      0.00        3     0.00    20.00  Object#Rational
  0.00   356.89      0.00        2     0.00     0.00  Module#attr
  0.00   356.89      0.00        7     0.00     7.14  Date#once
  0.00   356.89      0.00        1     0.00     0.00  Date#jd_to_civil
  0.00   356.89      0.00        1     0.00     0.00  File#initialize
  0.00   356.89      0.00        1     0.00    90.00  Date#new
  0.00   356.89      0.00        1     0.00 356550.00  Vpim::Icalendar#decode
  0.00   356.89      0.00        6     0.00     0.00  Fixnum#div
  0.00   356.89      0.00       14     0.00     0.00  Class#inherited
  0.00   356.89      0.00        2     0.00     0.00  Module#public
  0.00   356.89      0.00        1     0.00     0.00  Array#==
  0.00   356.89      0.00        2     0.00     0.00  Hash#keys
  0.00   356.89      0.00        1     0.00     0.00  Module#undef_method
  0.00   356.89      0.00        5     0.00     0.00  Module#append_features
  0.00   356.89      0.00       47     0.00     0.00  Fixnum#[]
  0.00   356.89      0.00        1     0.00    10.00  Vpim::DirectoryInfo#check_begin_end
  0.00   356.89      0.00        4     0.00     0.00  Float#coerce
  0.00   356.89      0.00       22     0.00     0.00  Module#alias_method
  0.00   356.89      0.00        2     0.00     0.00  Module#method_undefined
  0.00   356.89      0.00        6     0.00     0.00  Float#/
  0.00   356.89      0.00        1     0.00 285850.00  Vpim::Icalendar#initialize
  0.00   356.89      0.00        1     0.00     0.00  Date#initialize
  0.00   356.89      0.00        2     0.00     0.00  Array#+
  0.00   356.89      0.00        1     0.00  4800.00  Vpim.unfold
  0.00   356.89      0.00       12     0.00     0.00  Fixnum#<
  0.00   356.89      0.00       23     0.00     0.00  Module#private
  0.00   356.89      0.00        5     0.00     0.00  Module#include
  0.00   356.89      0.00        5     0.00     2.00  Rational#new!
  0.00   356.89      0.00        6     0.00     0.00  Fixnum#abs
  0.00   356.89      0.00       26     0.00     1.54  Fixnum#-
  0.00   356.89      0.00        1     0.00 44920.00  Vpim.decode
  0.00   356.89      0.00       26     0.00     0.00  Symbol#to_s
  0.00   356.89      0.00        1     0.00     0.00  Kernel.open
  0.00   356.89      0.00        1     0.00     0.00  Integer#to_r
  0.00   356.89      0.00        1     0.00     0.00  Rational#coerce
  0.00   356.89      0.00        1     0.00    70.00  Date#jd_to_ajd
  0.00   356.89      0.00        4     0.00     0.00  Fixnum#/
  0.00   356.89      0.00        1     0.00 356890.00  #toplevel

/opt/local/bin/ruby -I lib -rprofile ./profile.rb  356.98s user 10.38s system 100% cpu 6:07.22 total















ensemble:~/p/ruby/vpim/trunk % ruby -I lib profile.rb 
  %   cumulative   self              self     total
 time   seconds   seconds    calls  ms/call  ms/call  name
 21.81    68.34     68.34    79313     0.86     1.33  Vpim::DirectoryInfo::Field#name?

Ruby1.8 has #casecmp! Make Vpim.casecmp() that uses it, if available?

 19.56   129.63     61.29    16916     3.62    42.75  Array#each
  7.98   154.64     25.01    66300     0.38     1.78  Proc#call
  6.76   175.83     21.19   167734     0.13     0.13  String#downcase
  4.24   189.10     13.27     6506     2.04     3.06  Vpim::DirectoryInfo::Field#decode0
  2.75   197.71      8.61    79313     0.11     0.11  String#to_s
  2.74   206.28      8.57    66300     0.13     0.13  Proc#==
  2.66   214.61      8.33    83216     0.10     0.10  String#==
  2.35   221.97      7.36    14300     0.51     1.56  Vpim::DirectoryInfo#enum_by_name
  2.15   228.71      6.74    14300     0.47    13.28  Vpim::DirectoryInfo#each
  2.01   235.01      6.30     1300     4.85   189.24  Vpim::Icalendar::Vevent#initialize
  1.83   240.74      5.73    23413     0.24    23.04  Class#new
  1.82   246.44      5.70    14300     0.40    13.68  Vpim::Enumerator#each
  1.44   250.94      4.50    14300     0.31     0.31  Vpim::Enumerator#initialize
  1.44   255.44      4.50    14300     0.31     0.48  Proc#new
  1.37   259.74      4.30     7800     0.55    17.27  Vpim::DirectoryInfo#text
  1.23   263.59      3.85     5202     0.74     2.56  Vpim::DirectoryInfo::Field#value
  1.22   267.40      3.81        1  3810.00  4840.00  IO#each
  1.19   271.12      3.72     6506     0.57     3.69  Vpim::DirectoryInfo::Field#initialize
  1.06   274.43      3.31     6506     0.51     4.53  Vpim::DirectoryInfo::Field#decode
  1.05   277.72      3.29     5202     0.63     1.17  Vpim::DirectoryInfo::Field#param
  0.99   280.83      3.11     5200     0.60    14.05  Vpim::DirectoryInfo#field
  0.93   283.73      2.90     5202     0.56     1.73  Vpim::DirectoryInfo::Field#encoding
  0.89   286.52      2.79     7800     0.36    15.11  Enumerable.map
  0.78   288.97      2.45     2600     0.94     1.65  String#scan
  0.74   291.29      2.32    14300     0.16     0.16  Object#initialize
  0.56   293.03      1.74     6502     0.27     0.37  Hash#[]
  0.54   294.72      1.69        1  1690.00 31160.00  Array#collect
  0.45   296.14      1.42    16913     0.08     0.08  Array#<<
  0.44   297.51      1.37    13024     0.11     0.11  Fixnum#>
  0.35   298.61      1.10     1300     0.85     1.05  Vpim.decode_text
  0.33   299.63      1.02     6502     0.16     0.17  Kernel.===
  0.32   300.63      1.00     1303     0.77     1.17  Vpim::DirectoryInfo::Field#value?
  0.31   301.59      0.96     1301     0.74     3.25  Vpim::DirectoryInfo#initialize
  0.30   302.52      0.93    10405     0.09     0.09  Array#first
  0.27   303.36      0.84     1300     0.65     4.62  Vpim::DirectoryInfo::Field#to_text
  0.24   304.12      0.76     6526     0.12     0.12  Kernel.kind_of?
  0.23   304.85      0.73     7808     0.09     0.09  Module#===
  0.22   305.53      0.68     5202     0.13     0.13  Hash#default
  0.22   306.21      0.68     6506     0.10     0.10  String#size
  0.22   306.89      0.68     1301     0.52     4.96  Vpim.outer_inner
  0.21   307.55      0.66     6506     0.10     0.10  MatchData#[]
  0.21   308.21      0.66     6506     0.10     0.10  String#length
  0.20   308.85      0.64     6506     0.10     0.10  Kernel.freeze
  0.19   309.46      0.61    10411     0.06     0.06  Array#last
  0.19   310.05      0.59     7807     0.08     0.08  Array#push
  0.19   310.64      0.59     6506     0.09     0.09  String#chomp!
  0.18   311.21      0.57     1301     0.44     3.79  Vpim::DirectoryInfo#create
  0.13   311.63      0.42     6506     0.06     0.06  String#to_str
  0.12   312.02      0.39     1300     0.30    15.86  Vpim::DirectoryInfo#[]
  0.09   312.29      0.27     3900     0.07     0.07  String#gsub
  0.07   312.52      0.23     1302     0.18     2.51  Enumerable.detect
  0.06   312.71      0.19     1300     0.15     0.15  Hash#key?
  0.05   312.86      0.15       27     5.56    45.56  Kernel.require
  0.04   313.00      0.14     1300     0.11     0.11  Hash#[]=
  0.03   313.08      0.08     1300     0.06     0.06  String#upcase
  0.02   313.13      0.05     1301     0.04     0.04  Array#pop
  0.01   313.17      0.04        3    13.33    13.33  Integer#gcd
  0.01   313.20      0.03       28     1.07     1.43  Module#module_eval
  0.01   313.23      0.03      106     0.28     0.28  Kernel.singleton_method_added
  0.01   313.25      0.02      252     0.08     0.08  Module#method_added
  0.00   313.26      0.01       91     0.11     0.11  Fixnum#to_s
  0.00   313.27      0.01        3     3.33    16.67  Rational#reduce
  0.00   313.28      0.01        1    10.00    10.00  Date#jd_to_civil
  0.00   313.29      0.01       12     0.83     0.83  Fixnum#<
  0.00   313.30      0.01        1    10.00    10.00  Date#civil_to_jd
  0.00   313.31      0.01        2     5.00     5.00  Module#attr
  0.00   313.32      0.01       91     0.11     0.11  Symbol#to_i
  0.00   313.33      0.01        1    10.00    10.00  Rational#coerce
  0.00   313.33      0.00        1     0.00    70.00  Date#jd_to_ajd
  0.00   313.33      0.00        1     0.00     0.00  Kernel.singleton_method_undefined
  0.00   313.33      0.00       24     0.00     0.00  Fixnum#>>
  0.00   313.33      0.00        5     0.00     2.00  Rational#new!
  0.00   313.33      0.00        2     0.00     0.00  Array#join
  0.00   313.33      0.00        1     0.00     0.00  Vpim::DirectoryInfo#check_begin_end
  0.00   313.33      0.00        3     0.00     0.00  Fixnum#<<
  0.00   313.33      0.00        1     0.00 21940.00  Vpim.expand
  0.00   313.33      0.00        7     0.00     8.57  Date#once
  0.00   313.33      0.00        2     0.00     0.00  Date#os?
  0.00   313.33      0.00        2     0.00     5.00  Rational#/
  0.00   313.33      0.00        2     0.00     0.00  Array#+
  0.00   313.33      0.00        4     0.00     2.50  Module#attr_reader
  0.00   313.33      0.00        1     0.00     0.00  File#initialize
  0.00   313.33      0.00        5     0.00     0.00  Module#included
  0.00   313.33      0.00       75     0.00     0.00  Fixnum#==
  0.00   313.33      0.00        6     0.00     0.00  Fixnum#div
  0.00   313.33      0.00        4     0.00     0.00  Float#*
  0.00   313.33      0.00        2     0.00     0.00  Fixnum#<=
  0.00   313.33      0.00       82     0.00     0.00  Fixnum#*
  0.00   313.33      0.00        1     0.00     0.00  Array#==
  0.00   313.33      0.00        2     0.00     0.00  Hash#keys
  0.00   313.33      0.00        5     0.00     2.00  Rational#initialize
  0.00   313.33      0.00        1     0.00     0.00  Module#undef_method
  0.00   313.33      0.00       10     0.00     0.00  Float#floor
  0.00   313.33      0.00        1     0.00     0.00  Date#initialize
  0.00   313.33      0.00        8     0.00     0.00  Module#private_class_method
  0.00   313.33      0.00        1     0.00    20.00  Date#valid_civil?
  0.00   313.33      0.00       47     0.00     0.00  Fixnum#[]
  0.00   313.33      0.00        1     0.00    50.00  Rational#-
  0.00   313.33      0.00       22     0.00     0.45  Module#alias_method
  0.00   313.33      0.00        2     0.00     0.00  Module#method_undefined
  0.00   313.33      0.00        1     0.00 312970.00  Vpim::Icalendar#decode
  0.00   313.33      0.00        1     0.00 255020.00  Vpim::Icalendar#initialize
  0.00   313.33      0.00        1     0.00     0.00  Class#new0
  0.00   313.33      0.00       11     0.00     0.00  Fixnum#+
  0.00   313.33      0.00        3     0.00    16.67  Object#Rational
  0.00   313.33      0.00        1     0.00     0.00  Integer#to_r
  0.00   313.33      0.00       14     0.00     0.00  Class#inherited
  0.00   313.33      0.00        2     0.00     0.00  Module#public
  0.00   313.33      0.00        5     0.00     0.00  Module#append_features
  0.00   313.33      0.00        4     0.00     0.00  Float#coerce
  0.00   313.33      0.00        6     0.00     0.00  Float#/
  0.00   313.33      0.00        5     0.00     0.00  Module#include
  0.00   313.33      0.00        6     0.00     0.00  Fixnum#abs
  0.00   313.33      0.00       23     0.00     0.00  Module#private
  0.00   313.33      0.00        1     0.00 36000.00  Vpim.decode
  0.00   313.33      0.00       26     0.00     2.31  Fixnum#-
  0.00   313.33      0.00       26     0.00     0.00  Symbol#to_s
  0.00   313.33      0.00        1     0.00     0.00  Kernel.open
  0.00   313.33      0.00        1     0.00    90.00  Date#new
  0.00   313.33      0.00        1     0.00  4840.00  Vpim.unfold
  0.00   313.33      0.00        4     0.00     0.00  Fixnum#/
  0.00   313.33      0.00        1     0.00 313330.00  #toplevel

